<!DOCTYPE html>
<html>
<head>
  <title>Inventory CRUD</title>
  <style>
    table {border-collapse: collapse;}
    td, th {border:1px solid #333; padding:5px;}
  </style>
</head>
<body>

<h2>FORM INVENTORY</h2>
<input type="hidden" id="id">
<input id="nama" placeholder="Nama">
<input id="stok" placeholder="Stok">
<input id="lokasi" placeholder="Lokasi">
<button onclick="simpan()">Simpan</button>
<button onclick="reset()">Reset</button>

<h2>DATA</h2>
<table id="table"></table>

<script>
const API = "https://script.google.com/macros/s/AKfycbyeMT0ZnP2UpZrzY1ybNNDVQxRX2C_r8EdSiCzfYOpiLDu7X9sfj80s_3NPeLfb34U/exec";

function load() {
  fetch(API + "?action=get")
    .then(r => r.json())
    .then(data => {
      let html = "<tr><th>Nama</th><th>Stok</th><th>Lokasi</th><th>Aksi</th></tr>";
      data.slice(1).forEach(r => {
        html += `
        <tr>
          <td>${r[1]}</td>
          <td>${r[2]}</td>
          <td>${r[3]}</td>
          <td>
            <button onclick="edit('${r[0]}','${r[1]}','${r[2]}','${r[3]}')">Edit</button>
            <button onclick="hapus('${r[0]}')">Hapus</button>
          </td>
        </tr>`;
      });
      document.getElementById("table").innerHTML = html;
    });
}

function simpan() {
  const id = document.getElementById("id").value;
  const data = {
    action: id ? "update" : "create",
    id: id,
    nama: nama.value,
    stok: stok.value,
    lokasi: lokasi.value
  };

  fetch(API, {
    method: "POST",
    body: JSON.stringify(data)
  }).then(() => {
    reset();
    load();
  });
}

function edit(id,nama,stok,lokasi) {
  document.getElementById("id").value = id;
  document.getElementById("nama").value = nama;
  document.getElementById("stok").value = stok;
  document.getElementById("lokasi").value = lokasi;
}

function hapus(id) {
  if(confirm("Hapus data?")) {
    fetch(API + "?action=delete&id=" + id)
      .then(() => load());
  }
}

function reset() {
  id.value = "";
  nama.value = "";
  stok.value = "";
  lokasi.value = "";
}

load();
</script>
</body>
</html>
